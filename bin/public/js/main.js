// Generated by Haxe 3.4.4
(function () { "use strict";
var Main = function() {
	this._storage = null;
	this.storageName = "skeletor";
	this.hasStorage = false;
	this.contentArray = [];
	this.publicSpreadsheetUrl = "https://docs.google.com/spreadsheets/d/1KhcMZv01CfiAvCPhL8nVTXEJ2oRcLgSlj5UNX40jTsM/edit?usp=sharing";
	var _gthis = this;
	window.document.addEventListener("DOMContentLoaded",function(event) {
		window.console.log("Dom ready :: build: " + model_constants_App.BUILD + " ");
		if(_gthis.get_storage() != null) {
			console.log("hasStorage : " + (_gthis.hasStorage == null ? "null" : "" + _gthis.hasStorage));
		}
		_gthis.initHomepage();
		_gthis.initTabletop();
	});
};
Main.main = function() {
	var app = new Main();
};
Main.prototype = {
	get_storage: function() {
		if(window.localStorage.getItem(this.storageName) != null) {
			this._storage = window.localStorage.getItem(this.storageName);
			this.contentArray = JSON.parse(this._storage).data;
			this.hasStorage = true;
		}
		return this._storage;
	}
	,set_storage: function(value) {
		var obj = { date : new Date(), data : value};
		window.localStorage.setItem(this.storageName,JSON.stringify(obj));
		this.contentArray = JSON.parse(JSON.stringify(value));
		this.hasStorage = true;
		return this._storage = value;
	}
	,initHomepage: function() {
		this.vm = new Vue({ el : "#app", data : { showloading : !this.hasStorage, sheet : this.contentArray, message : "Content from this page from google spreadsheet and vue.js"}});
	}
	,initTabletop: function() {
		Tabletop.init({ key : this.publicSpreadsheetUrl, callback : $bind(this,this.showInfo), simpleSheet : true});
	}
	,showInfo: function(data,tabletop) {
		this.showSnackbar("Successfully updated!");
		this.vm.showloading = false;
		this.vm.sheet = data;
		this.set_storage(data);
	}
	,showSnackbar: function(msg) {
		var x = window.document.getElementById("snackbar");
		if(x == null) {
			var div = window.document.createElement("div");
			div.id = "snackbar";
			window.document.body.appendChild(div);
			x = div;
		}
		x.innerText = msg;
		x.className = "show";
		setTimeout(function() {
			x.className = x.className.replace("show","");
		},3000);
	}
};
var model_constants_App = function() { };
var $_, $fid = 0;
function $bind(o,m) { if( m == null ) return null; if( m.__id__ == null ) m.__id__ = $fid++; var f; if( o.hx__closures__ == null ) o.hx__closures__ = {}; else f = o.hx__closures__[m.__id__]; if( f == null ) { f = function(){ return f.method.apply(f.scope, arguments); }; f.scope = o; f.method = m; o.hx__closures__[m.__id__] = f; } return f; }
model_constants_App.BUILD = "2018-02-02 14:33:57";
Main.main();
})();

//# sourceMappingURL=main.js.map